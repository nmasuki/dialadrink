var OkHi;!function(o){for(var e=0;e<o.length;e++)!window[o[e]]||"prepend"in window[o[e]].prototype||(window[o[e]].prototype.prepend=function(){for(var o,e=Array.prototype.slice.call(arguments),t=document.createDocumentFragment(),n=0;n<e.length;n++)t.appendChild((o=e[n],("function"==typeof Node?o instanceof Node:o&&"object"==typeof o&&o.nodeName&&1<=o.nodeType&&o.nodeType<=12)?e[n]:document.createTextNode(String(e[n]))));this.appendChild(t)})}(["Element","CharacterData","DocumentType"]),function(){var w={env:"sandbox",namespace:"com.sandbox.okweb.okhi",name:"okWeb",version:"4.6.2",build:"4",okheart:{prod:"https://manager-v4.okhi.co",dev:"https://manager-v4.okhi.dev",sandbox:"https://sandbox-manager-v4.okhi.dev"},okvanilla:{prod:"https://card-v4.okhi.co",dev:"https://card-v4.okhi.dev",sandbox:"https://sandbox-card-v4.okhi.dev"},segment:{prod:"Basic YTZWYUxjY3hYZFBqTmJ0UHo2R01CeWtEMEVTRG5xUXg6",dev:"Basic SWVUYTJueE54MVdUVWIyaHN2SFNVdVhwUmZSbHVkTjA6"}},f=w.okheart[w.env],b=w.okvanilla[w.env];function x(){var o=function(o){try{for(var e=o+"=",t=document.cookie.split(";"),n=0;n<t.length;n++){for(var r=t[n];" "==r.charAt(0);)r=r.substring(1);if(0==r.indexOf(e))return r.substring(e.length,r.length)}return""}catch(o){return console.error(o),""}}("okhi_anonymous_id");return o||(function(o,e,t){var n="expires=",r=new Date;r.setTime(r.getTime()+365*t*24*60*60*1e3),n+=r.toUTCString();try{document.cookie=o+"="+e+";"+n+";path=/"}catch(o){console.error(o)}}("okhi_anonymous_id",o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){var e=16*Math.random()|0;return("x"==o?e:3&e|8).toString(16)}),20),o)}function y(){var o=document.getElementsByTagName("html")[0],e=document.createElement("iframe"),t=document.createElement("div"),n=document.getElementById("okhi-launch-manager-modal"),r=document.getElementById("okhi-modal-container");n&&n.parentNode.removeChild(n),r&&r.parentNode.removeChild(r),o?(e.style.border="none",e.style.width="100%",e.style.height="100%",e.style.margin="auto",e.setAttribute("allow","geolocation"),e.setAttribute("src",f),e.setAttribute("id","okhi-launch-manager-modal"),t.prepend(e),t.setAttribute("id","okhi-modal-container"),t.style.position="fixed",t.style.left=0,t.style.right=0,t.style.top=0,t.style.bottom=0,t.style.zIndex=1e10,t.style.backgroundColor="rgba(255, 255, 255, 0.95)",t.style.display="none",t.style.overflow="hidden",o.prepend(t)):console.error("html tag not found. Please ensure there's a html tag in the HTML document and you've included the script at the bottom of the HTML docuemnt.")}function k(o){return"object"!=typeof o?{valid:!1,error:"missing configuration object"}:o.apiKey?{valid:!0}:{valid:!1,error:"invalid api key provided"}}function E(o){var e,t,n,r,i,a,s,c,d,l,u=this.auth,p=k(u);if(!p.valid)throw new Error(p.error);if("object"!=typeof o)throw new Error("missing configuration object for LocationCard");if(!o.user)throw new Error("missing user in configuration object for LocationCard");if(o.user&&!o.user.phone)throw new Error("missing phone in user configuration object for LocationCard");if(o.location&&!o.location.id)throw new Error("missing id in location configuration object for LocationCard");function h(o,e){var t,n=e||{},r=document.getElementById("okhi-launch-manager-modal").contentWindow;t=JSON.stringify({message:o,payload:n}),"prod"!==w.env&&console.log("[okweb] sending",o,"with payload",e),r.postMessage(t,f)}function g(){var o=function(){var o={};return n&&(o.style=n),t&&(o.address=t),r&&(o.config=r),o.auth=u,o.user=e,o.parent=w,o}();l&&l.location&&(o.location=l.location),l&&l.mode?"select_location"===l.mode&&h("select_location",o):h("start_app",o)}function m(o){var e;o.origin===f&&(c=c||o,(e=JSON.parse(o.data)).message&&e.payload?("prod"!==w.env&&console.log("[okweb] received",e.message,"with payload",e.payload),function(o,e){"location_created"===o||"location_updated"===o||"location_selected"===o?(d(),i(e)):"fatal_exit"===o?(a({error_code:"fatal_exit",message:e}),d()):"exit_app"===o&&(d(),s&&s())}(e.message,e.payload)):a({error_code:"general_exception",message:"something went wrong"}))}"function"==typeof o.onClose&&(s=o.onClose),(e=o.user).anonymousId=x(),t=o.location||void 0,n=o.style||void 0,r=o.config||void 0,i=o.onSuccess||function(){},a=o.onError||function(){},d=function(){window.removeEventListener("message",m,!1),y()},this.launch=function(o){var e=document.getElementById("okhi-modal-container");l=o,e.style.display="block",window.addEventListener("message",m,!1),g()},this.close=d}function r(o){var t,n,r,i,e,a,s,c,d,l=this.auth,u=k(l),p=E;if(!u.valid)throw new Error(u.error);if("object"!=typeof o)throw new Error("missing configuration object for LocationCard");if(!o.element)throw new Error("missing element in configuration object for LocationCard");if(!o.user)throw new Error("missing user in configuration object for LocationCard");if(o.user&&!o.user.phone)throw new Error("missing phone in user configuration object for LocationCard");if(o.location&&!o.location.id)throw new Error("missing id in location configuration object for LocationCard");function h(o){var e=document.createElement("iframe");e.setAttribute("id","okhi-location-card"),e.style.border="none",e.style.width="100%",e.style.height="100%",e.style.minHeight="162px",e.style.display="block",e.setAttribute("src",b),o(),t.prepend(e)}function g(o,e){var t,n=e||{};if(d.origin===b&&d.source&&d.source.postMessage){if(!o)throw new Error("invalid message object");"prod"!==w.env&&console.log("[okweb] sending",o,"with payload",e),t=JSON.stringify({message:o,payload:n}),d.source.postMessage(t,d.origin)}}function m(){var o={};return r&&(o.style=r),e&&(o.copy=e),c&&(o.location=c),i&&(o.config=i),o.auth=l,o.user=n,o.parent=w,o}function f(o,e){"app_state"!==o||!0!==e.ready||c?"app_state"===o&&!0===e.ready&&c?g("show_location",m()):"create_location"===o?new p({style:r,user:n,onSuccess:function(o){var e=m();e.location=o.location,s(o),g("show_location",e)},onError:a,config:i}).launch():"select_location"===o?function(o){var e;o&&o.location&&(e=o.location),new p({style:r,user:n,onSuccess:function(o){var e=m();e.location=o.location,s(o),g("show_location",e)},onError:a,config:i}).launch({mode:"select_location",location:e})}(e):"location_retrieved"===o&&s(e):g("start_app",m())}function y(o){var e;o.origin===b&&(d=o,(e=JSON.parse(o.data)).message&&e.payload?("prod"!==w.env&&console.log("[okweb] received",e.message,"with payload",e.payload),f(e.message,e.payload)):a({error_code:"general_exception",message:"something went wrong"}))}function v(){window.addEventListener("message",y,!1)}t=o.element,(n=o.user).anonymousId=x(),r=o.style||void 0,i=o.config||void 0,e=o.copy||void 0,a=o.onError||void 0,s=o.onSuccess||void 0,c=o.location||void 0,p.prototype.auth=l,h(v),Object.defineProperty(this,"user",{set:function(o){if(!(o&&o.phone&&o.phone))throw Error("user phone is required");n=o,c=void 0,function(){var o=document.getElementById("okhi-location-card");o.parentNode.removeChild(o),window.removeEventListener("message",y,!1)}(),h(v)}})}"function"!=typeof OkHi&&(OkHi=function(o){var e=E,t=r,n=k(o);if(!n.valid)throw new Error(n.error);e.prototype.auth=o,t.prototype.auth=o,this.LocationManager=e,this.LocationCard=t,function(o){var e=w.segment[w.env],t=new XMLHttpRequest,n={anonymousId:x(),event:"App Ready",properties:{affl:"object"!=typeof o?void 0:o.apiKey.substr(o.apiKey.length-6),origin:window.location.origin,pathname:window.location.pathname,clientProduct:"okWebJSLib",product:"okWebJSLib"}};try{t.open("POST","https://api.segment.io/v1/track"),t.setRequestHeader("Content-Type","application/json;charset=UTF-8"),t.setRequestHeader("Authorization",e),t.send(JSON.stringify(n)),"prod"!==w.env&&console.log("Tracking  App Ready",n)}catch(o){return}}(o)}),y()}();