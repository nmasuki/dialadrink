var CACHE_VERSION=4.1;function getCacheName(e){return e+"s-v"+CACHE_VERSION}function updateCache(n,t){return caches.open(getCacheName(n.destination)).then(function(e){try{return e.put(n,t.clone()).catch(console.log)}catch(e){console.warn(e)}return null})}function fetchCached(n){return n.headers.get("X-CSRF-Token")?fetchOnline(n,!1):caches.open(getCacheName(n.destination)).then(function(e){return e.match(n).then(function(e){return e&&404!=e.status?e.clone():(console.log("[PWA] No cache match. Serving content from http!",n.url),fetchOnline(n,!0))}).catch(function(e){console.warn(e)})}).catch(function(e){return console.warn(e),fetch(n)})}function fetchOnline(n,t,c){return fetch(n).then(function(e){return n.headers.get("X-CSRF-Token")?Promise.resolve(e.clone()):0<=n.url.indexOf("/admin")?Promise.resolve(e.clone()):c?(c.waitUntil(updateCache(n,e)),Promise.resolve(e.clone())):updateCache(n,e).then(function(){return e.clone()})}).catch(function(e){return console.log("[PWA] Network request Failed. "+e),t?(console.log("[PWA] Serving content from cache:",n.url),fetchCached(n,!1)):Promise.reject("no-match")})}self.addEventListener("activate",function(e){e.waitUntil(caches.keys().then(function(e){return Promise.all(e.map(function(e){if(!e.endsWith("-v"+CACHE_VERSION))return console.log("Deleting out of date cache:",e),caches.delete(e)}))}))}),self.addEventListener("install",function(e){var t=new Request("/index.html",{destination:"document"});e.waitUntil(fetch(t).then(function(n){return caches.open("documents-v"+CACHE_VERSION).then(function(e){try{return e.put(t,n)}catch(e){console.warn(e)}return null}).catch(function(e){console.warn(e)})}).catch(function(e){console.warn(e)}))}),self.addEventListener("fetch",function(e){"document"==e.request.destination?e.respondWith(fetchOnline(e.request,!0,e)):e.respondWith(fetchCached(e.request,!0,e))});