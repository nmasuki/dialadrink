$(document).ready(function(){window.addressData=window.addressData||null,$(document).on("load","#lets-okhi-card iframe",function(){console.log(arguments)}),$(document).on("error","#lets-okhi-card iframe",function(){console.error(arguments)}),window.loadLocationCard=function(e){$("#lets-okhi").hide();var o,a;(e=e||{phone:$("#phoneNumber").val()||"",firstName:$("#firstName").val(),lastName:$("#lastName").val()}).phone="+"+e.phone.cleanPhoneNumber(),e.firstName||delete e.firstName,e.lastName||delete e.lastName,e.phone&&10<=e.phone.length&&(a=setTimeout(function(){window.addressData||$("#lets-okhi-card").html()||($("#lets-okhi").hide(),$("#lets-okhi-card").parent().hide(),$("#addressInputs").slideDown(),$(".alert-danger").find(".msg-text").html("<strong>Input Error while detecting your location! Please enter your address</strong>"),$(".alert-danger").slideDown())},5e3),window.addressData=null,window.locationCard?window.locationCard.user=new window.okhi.OkHiUser(e):(o=document.getElementById("lets-okhi-card"),window.locationCard=new window.okhi.OkHiLocationCard({user:new window.okhi.OkHiUser(e),style:okhiStyle},o,function(e,o){if(e)return function(e){if(clearTimeout(a),window.addressData=null,"invalid_phone"==e.code)return $(".alert-danger").find(".msg-text").html("<strong>"+e.message+"</strong>"),void $(".alert-danger").slideDown();console.warn("Error Implimentation not done!",e),$("#lets-okhi").animate({width:"toggle"},350),$("#lets-okhi-card").hide()}(e);o=o,clearTimeout(a),window.addressData=o,window.addressData&&(app.cartUtil.loadCharges(window.addressData.location),app.cartUtil.updateView()),o&&o.user&&o.location?($("#lets-okhi").hide(),o.user.firstName&&$("#firstName").val(o.user.firstName),o.user.lastName&&$("#lastName").val(o.user.lastName),$("[name=address]").val(o.location.title),$("[name=building]").val(o.location.streetName),$("[name=houseNumber]").val([o.location.propertyName,o.location.directions].join(", ").trim().trim(","))):($("#lets-okhi").show(),$("#lets-okhi-card").hide())})))},window.loadLocationLookUp=function(e){var a;(e=e||{phone:$("#phoneNumber").val()||"",firstName:$("#firstName").val(),lastName:$("#lastName").val()}).phone="+"+e.phone.cleanPhoneNumber(),e.phone&&e.firstName&&e.lastName?(a=setTimeout(function(){$("##lets-okhi-card").html()||loadLocationCard(e)},5e3),new okhi.OkHiLocationManager({user:new window.okhi.OkHiUser(e),config:okhiConfig,style:okhiStyle,mode:okhi.OkHiLocationManagerLaunchMode.select_location}).launch(function(e,o){return e?(e=e,clearTimeout(a),window.addressData=null,$("#lets-okhi").animate({width:"toggle"},350),$("#addressInputs").slideDown(),$(".alert-danger").find(".msg-text").html("<strong>Input Error while detecting your location!</strong> "+e),void $(".alert-danger").slideDown()):(o=o,clearTimeout(a),window.addressData=o,$("#lets-okhi").animate({width:"toggle"},350),$("#submitBtn").show(),$("[name=address]").val(o.location.title),$("[name=building]").val(o.location.streetName),$("[name=houseNumber]").val([o.location.propertyName,o.location.directions].join(", ").trim().trim(",")),$("#lets-okhi").parent().show(),void loadLocationCard())})):($(".alert-danger").find(".msg-text").html("<strong>Input Error!</strong> Invalid input found! Please fill in your <b>names</b> and <b>phone number</b>."),$(".alert-danger").slideDown())},$(document).on("change","#phoneNumber",function(e){loadLocationCard({firstName:$("#firstName").val(),lastName:$("#lastName").val(),phone:$("#phoneNumber").val()})}),$(document).on("click","#lets-okhi",function(e){e.preventDefault();$(this).parents("form");$(".alert-danger").hide(),loadLocationLookUp()})});